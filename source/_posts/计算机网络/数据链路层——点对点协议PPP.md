


对于点对点的链路，目前使用得最广泛的数据链路层协议是点对点协议 PPP (Point-to-Point Protocol)。
# PPP 协议的特点
互联网用户通常都要连接到某个ISP才能接入到互联网。PPP协议就是用户计算机和ISP进行通信时所使用的数据链路层协议。
{% asset_img img1.png %}
## PPP 协议应满足的需求
简单 —— 这是首要的要求。
封装成帧 —— 必须规定特殊的字符作为帧定界符。
透明性 —— 必须保证数据传输的透明性。
多种网络层协议 —— 能够在同一条物理链路上同时支持多种网络层协议。
多种类型链路 —— 能够在多种类型的链路上运行。
差错检测 —— 能够对接收端收到的帧进行检测，并立即丢弃有差错的帧。
检测连接状态 —— 能够及时自动检测出链路是否处于正常工作状态。
最大传送单元 —— 必须对每一种类型的点对点链路设置最大传送单元  MTU 的标准默认值，促进各种实现之间的互操作性。
网络层地址协商 —— 必须提供一种机制使通信的两个网络层实体能够通过协商知道或能够配置彼此的网络层地址。
数据压缩协商 —— 必须提供一种方法来协商使用数据压缩算法。
PPP 协议不需要的功能：
纠错 
流量控制 
序号 
多点线路 
半双工或单工链路 

## PPP 协议的组成
PPP 协议有三个组成部分：
* 一个将 IP 数据报封装到串行链路的方法。
* 链路控制协议 LCP (Link Control Protocol)。
* 网络控制协议 NCP (Network Control Protocol)。

# PPP 协议的帧格式
## 各字段的意义
PPP 帧的首部和尾部分别为 4 个字段和 2 个字段。
标志字段 F = 0x7E （符号“0x”表示后面的字符是用十六进制表示。十六进制的 7E 的二进制表示是 01111110）。
地址字段 A 只置为 0xFF。地址字段实际上并不起作用。
控制字段 C 通常置为 0x03。
PPP 是面向字节的，所有的 PPP 帧的长度都是整数字节。

{% asset_img img2.png %}

透明传输问题：
当 PPP 用在异步传输时，就使用一种特殊的字符填充法。
当 PPP 用在同步传输链路时，协议规定采用硬件来完成比特填充（和 HDLC 的做法一样）。

## 字符填充
将信息字段中出现的每一个 0x7E 字节转变成为 2 字节序列 (0x7D, 0x5E)。 
若信息字段中出现一个 0x7D 的字节, 则将其转变成为 2 字节序列 (0x7D, 0x5D)。
若信息字段中出现 ASCII 码的控制字符（即数值小于 0x20 的字符），则在该字符前面要加入一个 0x7D 字节，同时将该字符的编码加以改变。

{% asset_img img3.png %}

## 零比特填充
PPP 协议用在 SONET/SDH 链路时，使用同步传输（一连串的比特连续传送）。这时 PPP 协议采用零比特填充方法来实现透明传输。
在发送端，只要发现有 5 个连续 1，则立即填入一个 0。
接收端对帧中的比特流进行扫描。每当发现 5 个连续1时，就把这 5 个连续 1 后的一个 0 删除。

{% asset_img img4.png %}

PPP 协议之所以不使用序号和确认机制是出于以下的考虑：
在数据链路层出现差错的概率不大时，使用比较简单的 PPP 协议较为合理。
在因特网环境下，PPP 的信息字段放入的数据是 IP  数据报。数据链路层的可靠传输并不能够保证网络层的传输也是可靠的。
帧检验序列 FCS 字段可保证无差错接受。
# PPP 协议的工作状态
当用户拨号接入 ISP 时，路由器的调制解调器对拨号做出确认，并建立一条物理连接。
PC 机向路由器发送一系列的 LCP 分组（封装成多个 PPP 帧）。
这些分组及其响应选择一些 PPP 参数，并进行网络层配置，NCP 给新接入的 PC 机分配一个临时的 IP 地址，使 PC 机成为因特网上的一个主机。
通信完毕时，NCP 释放网络层连接，收回原来分配出去的 IP 地址。接着，LCP 释放数据链路层连接。最后释放的是物理层的连接。
可见，PPP 协议已不是纯粹的数据链路层的协议，它还包含了物理层和网络层的内容。

{% asset_img img5.png %}