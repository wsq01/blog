


P2P应用就是指具有 P2P 体系结构的网络应用。所谓 P2P 体系结构就是在这样的网络应用中，没有或只有极少数的固定服务器，而绝大多数的交互都是使用对等方式（P2P方式）进行的。

在 P2P 工作方式下，所有的音频/视频文件都是在普通的互联网用户之间传输。这种工作方式解决了集中式媒体服务器可能出现的瓶颈问题。

在互联网流量中，P2P 工作方式下的文件分发已占据了最大的份额，比万维网应用所占的比例大得多。
# 具有集中目录服务器的 P2P 工作方式
Napster 最早使用 P2P 技术，提供免费下载 MP3 音乐。Napster 将所有音乐文件的索引信息都集中存放在 Napster 目录服务器中。使用者只要查找目录服务器，就可知道应从何处下载所要的MP3文件。用户要及时向 Napster 的目录服务器报告自己存有的音乐文件。

Napster 的文件传输是分散的，文件的定位则是集中的。

## Napster 的工作过程
{% asset_img img1.png %}
{% asset_img img2.png %}
{% asset_img img3.png %}
{% asset_img img4.png %}

集中式目录服务器的缺点：可靠性差、会成为性能的瓶颈。
# 具有全分布式结构的 P2P 文件共享程序
Gnutella 是第二代 P2P 文件共享程序，采用全分布方法定位内容的 P2P 文件共享应用程序。

Gnutella 与 Napster 最大的区别是：不使用集中式的目录服务器，而是使用洪泛法在大量 Gnutella 用户之间进行查询。

为了不使查询的通信量过大，Gnutella 设计了一种有限范围的洪泛查询，以减少倾注到互联网的查询流量，但也影响到查询定位的准确性。
## 使用 P2P 的比特洪流 BT


# P2P 文件分发的分析
从互联网传送数据到主机，叫做下载(`download`)，从主机向互联网传送，则称为上传 (upload) 或上载。

有 N 台主机从服务器下载一个大文件，其长度为 F bit。假定主机与互联网连接的链路的上传速率和下载速率分别为 ui 和 di ，单位都是 bit/s。


# 在 P2P 对等方中搜索对象
Napster在一个集中式目录服务器中构建的查找数据库虽然很简单，但性能上却有瓶颈。
Gnutella是一种采用全分布方法定位内容的P2P文件共享应用程序，它解决了集中式目录服务器所造成的瓶颈问题。然而Gnutella是在非结构化的覆盖网络中采用查询洪泛的方法来进行查找的，因此查找的效率较低。
现在广泛使用的索引和查找技术叫做分布式散列表 DHT (Distributed Hash Table)。DHT 也可译为分布式哈希表，它是由大量对等方共同维护的散列表。
广泛使用的 Chord 算法是美国麻省理工大学于2001 年提出的。
分布式散列表 DHT 利用散列函数，把资源名 K 及其存放的结点 IP 地址 N 都分别映射为资源名标识符 KID 和结点标识符 NID。
Chord 把结点按标识符数值从小到大沿顺时针排列成一个环形覆盖网络。
