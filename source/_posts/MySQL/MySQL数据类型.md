---
title: MySQL 数据类型
date: 2020-04-14 15:56:12
tags: [MySQL]
categories: [MySQL]
---


# MySQL数据类型
数据类型是定义列中可以存储什么数据以及该数据实际怎样存储的基本规则。

MySQL 提供了多种数据类型，主要包括数值类型、字符串类型、日期和时间类型。
## 字符串类型
有两种基本的字符串类型，分别为定长串和变长串。定长串接受长度固定的字符串，其长度是在创建表时指定的。定长列不允许多于指定的字符数目。它们分配的存储空间与指定的一样多。变长串存储可变长度的文本。有些变长数据类型具有最大的定长，而有些则是完全变长的。不管是哪种，只有指定的数据得到保存（额外的数据不保存）。

| 字符串类型 | 字节 | 描述及存储需求 |
| :--: | :--: | :--: |
| CHAR(M) | M | M 为 0～255 之间的整数，它的长度必须在创建时指定，否则 MySQL 假定为 CHAR(1) |
| VARCHAR(M) | | M 为 0～65535 之间的整数，值的长度 +1 个字节 |
| TINYBLOB | | 允许长度 0～255 字节，值的长度 +1 个字节 |
| BLOB | | 允许长度 0～65535 字节，值的长度 +2 个字节 |
| MEDIUMBLOB | | 允许长度 0～167772150 字节，值的长度 +3 个字节 |
| LONGBLOB | | 允许长度 0～4294967295 字节，值的长度 +4 个字节 |
| TINYTEXT | | 允许长度 0～255 字节，值的长度 +2 个字节 |
| TEXT | | 允许长度 0～65535 字节，值的长度 +2 个字节 |
| MEDIUMTEXT | | 允许长度 0～167772150 字节，值的长度 +3 个字节 |
| LONGTEXT | | 允许长度 0～4294967295 字节，值的长度 +4 个字节 |
| VARBINARY(M) |  | 允许长度 0～M 个字节的变长字节字符串，值的长度 +1 个字节 |
| BINARY(M) | M | 允许长度 0～M 个字节的定长字节字符串 |
| ENUM | | 在创建表时通过枚举方式显式指定，对 1～255 个成员的枚举需要 1 个字节存储；对于 255～65535 个成员，需要 2 个字节存储 |
| SET | | 接受最多64个串组成的一个预定义集合的零个或多个串 |

#### CHAR 和 VARCHAR 类型
`CHAR`和`VARCHAR`很类似，都用来保存 MySQL 中较短的字符串。二者的主要区别在于存储方式的不同：`CHAR`列的长度固定为创建表时声明的长度，长度可以为从 0～255 的任何值；而`VARCHAR`列中的值为可变长字符串，长度可以指定为 0～255（5.0.3 以前）或者 65535（5.0.3以后）之间的值。在检索的时候，`CHAR`列删除了尾部的空格，而`VARCHAR`则保留这些空格。

#### BINARY 和 VARBINARY 类型
`BINARY`和`VARBINARY`类似于`CHAR`和`VARCHAR`，不同的是它们包含二进制字符串而不包含非二进制字符串。
```sql
CREATE TABLE t (c BINARY(3));

INSERT INTO t SET c = 'a';

SELECT *, hex( c ), c = 'a', c = 'a\0', c = 'a\0\0' FROM t;
/*
+------+--------+-------+---------+-----------+
|  c   | hex(c) | c='a' | c='a\0' | c='a\0\0' |
+------+--------+-------+---------+-----------+
|  a   | 610000 |   0   |    0    |     1     | 
+------+--------+-------+---------+-----------+
*/
```
可以发现，当保存`BINARY`值时，在值的最后通过填充`0x00`（零字节）以达到指定的字段定义长度。
#### ENUM 类型
ENUM 中文名称叫枚举类型，它的值范围需要在创建表时通过枚举方式显式指定，对 1～255 个成员的枚举需要 1 个字节存储；对于 255～65535 个成员，需要 2 个字节存储。最多允许有 65535 个成员。
```sql
CREATE TABLE t ( gender enum ( 'M', 'F' ) );
INSERT INTO t VALUES ( 'M' ),( '1' ),( 'F' ),( NULL );
/*
+--------+
| gender |
+--------+
|   M    |
|   M    |
|   F    |
|  NULL  |
+--------+
*/
```
从上面的例子中，可以看出`ENUM`类型是忽略大小写的，对`'M'、'f'`在存储的时候将它们都转成了大写，还可以看出对于插入不在`ENUM`指定范围内的值时，并没有返回警告，而是插入了`enum('M','F')`的第一值`'M'`，这点用户在使用时要特别注意。另外，`ENUM`类型只允许从值集合中选取单个值，而不能一次取多个值。
#### SET 类型
`Set`和`ENUM`类型非常类似，也是一个字符串对象，里面可以包含 0～64 个成员。根据成员的不同，存储上也有所不同。
* 1～8 成员的集合，占 1 个字节。
* 9～16 成员的集合，占 2 个字节。
* 17～24 成员的集合，占 3 个字节。
* 25～32 成员的集合，占 4 个字节。
* 33～64 成员的集合，占 8 个字节。

`Set`和`ENUM`除了存储之外，最主要的区别在于`Set`类型一次可以选取多个成员，而`ENUM`则只能选一个。
```sql
CREATE TABLE t (col SET ( 'a', 'b', 'c', 'd' );
INSERT INTO t VALUES ( 'a,b' ),( 'a,d,a' ),( 'a,b' ),( 'a,c' ),( 'a' );
SELECT * FROM t;
/*
+------+
| col  |
+------+
| a,b  |
| a,d  |
| a,b  |
| a,c  |
|  a   |
+------+
*/
```
`SET`类型可以从允许值集合中选择任意 1 个或多个元素进行组合，所以对于输入的值只要是在允许值的组合范围内，都可以正确地注入到`SET`类型的列中。对于超出允许值范围的值例如`（'a,d,f'）`将不允许注入到上面例子中设置的`SET`类型列中，而对于`（'a,d,a'）`这样包含重复成员的集合将只取一次，写入后的结果为`a,d`，这一点请注意。
## 数值类型
MySQL 支持多种数值类型，每种存储的数值具有不同的取值范围。显然，支持的取值范围越大，所需存储空间越多。此外，有的数值数据类型支持使用十进制小数点（和小数），而有的则只支持整数。

所有数值类型（除`BIT`和`BOOLEAN`外）都可以有符号或无符号。有符号数值列可以存储正或负的数值，无符号数值列只能存储正数。默认情况为有符号，但如果你知道自己不需要存储负值，可以使用`UNSIGNED`关键字，这样做将允许你存储两倍大小的值。

MySQL 中的数值类型：

| 整数类型 | 字节 | 最小值 | 最大值 |
| :--: | :--: | :--: | :--: |
| TINYINT | 1 | 有符号-128，无符号 0 | 有符号 127，无符号 255 |
| SMALLINT | 2 | 有符号-32768，无符号 0 | 有符号 32767，无符号 65535 |
| MEDIUMINT | 3 | 有符号-8388608，无符号 0 | 有符号 8388607，无符号 1677215 |
| INT或INTEGER | 4 | 有符号-2147483648，无符号 0 | 有符号 2147483647，无符号 4294967295 |
| BIGINT | 8 | 有符号 -9223372036854775808，无符号 0 | 有符号 9223372036854775807，无符号 18446744073709551615 |

| 浮点数类型 | 字节 | 最小值 | 最大值 |
| :--: | :--: | :--: | :--: |
| FLOAT | 4 | ±1.175494351E-38 | ±3.402823466E+38 |
| DOUBLE | 8 | ±2.2250738585072014E-308 | ±1.7976931348623157E+308 |

| 定点数类型 | 字节 | 描述 |
| :--: | :--: | :--: |
| DEC(M,D)或DECIMAL(M,D) | M+2 | 精度可变的浮点值，最大取值范围与 DOUBLE 相同，给定 DECIMAL 的有效取值范围由 M 和 D 决定 |

| 位类型 | 字节 | 最小值 | 最大值 |
| :--: | :--: | :--: | :--: |
| BIT(M) | 1~8 | BIT(1) | BIT(64) |

#### 整数类型注意事项
在整数类型中，按照取值范围和存储方式不同，分为`tinyint、smallint、mediumint、int、bigint`这 5 个类型。如果超出类型范围的操作，会发生`Out of range`错误提示。为了避免此类问题发生，在选择数据类型时要根据应用的实际情况确定其取值范围，最后根据确定的结果慎重选择数据类型。

对于整型数据，MySQL 还支持在类型名称后面的小括号内指定显示宽度，例如`int(5)`表示当数值宽度小于 5 位的时候在数字前面填满宽度，如果不显示指定宽度则默认为`int(11)`。一般配合`zerofill`使用，`zerofill`默认为`int(10)`，顾名思义，`zerofill`就是用“0”填充的意思，也就是在数字位数不够的空间用字符“0”填满。
```sql
CREATE TABLE t1(id1 int, id2 int(5));
INSERT INTO t1 VALUES(1, 1);
SELECT * FROM t1;
/*
+------+------+
| id1  | id2  |
+------+------+
|  1   |  1   | 
+------+------+
*/
ALTER TABLE t1 MODIFY id1 INT ZEROFILL;
ALTER TABLE t1 MODIFY id2 INT(5) ZEROFILL;
SELECT * FROM t1;
/*
+------------+-------+
|     id1    |  id2  |
+------------+-------+
| 0000000001 | 00001 | 
+------------+-------+
*/
```
设置了宽度限制后，如果插入大于宽度限制的值，不会对插入的数据有任何影响，还是按照类型的实际精度进行保存，这时，宽度格式实际已经没有意义，左边不会再填充任何的“0”字符。
```sql
INSERT INTO t1 VALUES(1, 1111111);
SELECT * FROM t1;
/*
+------------+---------+
|     id1    |   id2   |
+------------+---------+
| 0000000001 | 00001   | 
| 0000000001 | 1111111 | 
+------------+---------+
*/
```
所有的整数类型都有一个可选属性`UNSIGNED`（无符号），如果需要在字段里面保存非负数或者需要较大的上限值时，可以用此选项，它的取值范围是正常值的下限取 0，上限取原值的 2 倍。

如果一个列指定为`zerofill`，则 MySQL 自动为该列添加`UNSIGNED`属性。

另外，整数类型还有一个属性：`AUTO_INCREMENT`。在需要产生唯一标识符或顺序值时，可利用此属性，这个属性只用于整数类型。`AUTO_INCREMENT`值一般从 1 开始，每行增加 1。在插入`NULL`到一个`AUTO_INCREMENT`列时，MySQL 插入一个比该列中当前最大值大 1 的 值。一个表中最多只能有一个`AUTO_INCREMENT`列。对于任何想要使用`AUTO_INCREMENT`的列，应该定义为`NOT NULL`，并定义为`PRIMARY KEY`或定义为`UNIQUE`键。例如，可按下列任何一种方式定义`AUTO_INCREMENT`列：
```sql
CREATE TABLE AI(ID INT AUTO_INCREMENT NOT NULL PRIMARY KEY);
CREATE TABLE AI(ID INT AUTO_INCREMENT NOT NULL ,PRIMARY KEY(ID));
CREATE TABLE AI(ID INT AUTO_INCREMENT NOT NULL ,UNIQUE(ID));
```
#### 浮点数类型注意事项
对于小数的表示，MySQL 分为两种方式：浮点数和定点数。浮点数包括`float`（单精度） 和`double`（双精度），而定点数则只有`decimal`一种表示。定点数在 MySQL 内部以字符串形式存放，比浮点数更精确，适合用来表示货币等精度高的数据。

浮点数和定点数都可以用类型名称后加`(M,D)`的方式来进行表示，`(M,D)`表示该值一共显示`M`位数字（整数位+小数位），其中`D`位位于小数点后面，`M`和`D`又称为精度和标度。例如，定义为 `float(7,4)`的一个列可以显示为`-999.9999`。MySQL 保存值时进行四舍五入，因此如果在`float(7,4)`列内插入`999.00009`，近似结果是`999.0001`。值得注意的是，浮点数后面跟`(M,D)`的用法是非标准用法，如果要用于数据库的迁移，则最好不要这么使用。

`float`和`double`在不指定精度时，默认会按照实际的精度（由实际的硬件和操作系统决定）来显示，而`decimal`在不指定精度时，默认的整数位为 10，默认的小数位为 0。
```sql
CREATE TABLE t1 (
	id1 FLOAT (5, 2) DEFAULT NULL,
	id2 DOUBLE (5, 2) DEFAULT NULL,
	id3 DECIMAL (5, 2) DEFAULT NULL 
)
INSERT INTO t1 VALUES(1.23,1.23,1.23);
SELECT * FROM t1;
/*
+------+------+------+
|  id1 |  id2 |  id3 |
+------+------+------+
| 1.23 | 1.23 | 1.23 | 
+------+------+------+
*/
INSERT INTO t1 VALUES(1.234,1.234,1.23);
SELECT * FROM t1;
/*
+------+------+------+
|  id1 |  id2 |  id3 |
+------+------+------+
| 1.23 | 1.23 | 1.23 | 
| 1.23 | 1.23 | 1.23 | 
+------+------+------+
*/
INSERT INTO t1 VALUES(1.234,1.234,1.234);
SELECT * FROM t1;
/*
+------+------+------+
|  id1 |  id2 |  id3 |
+------+------+------+
| 1.23 | 1.23 | 1.23 | 
| 1.23 | 1.23 | 1.23 | 
| 1.23 | 1.23 | 1.23 | 
+------+------+------+
*/
ALTER TABLE t1 MODIFY id1 FLOAT;
ALTER TABLE t1 MODIFY id2 DOUBLE;
ALTER TABLE t1 MODIFY id3 DECIMAL;
INSERT INTO t1 VALUES(1.234,1.234,1.234);
SELECT * FROM t1;
/*
+-------+-------+------+
|  id1  |  id2  |  id3 |
+-------+-------+------+
| 1.234 | 1.234 |  1   | 
+-------+-------+------+
*/

```
上面这个例子验证了上面提到的浮点数如果不写精度和标度，则会按照实际精度值显示，如果有精度和标度，则会自动将四舍五入后的结果插入，系统不会报错；定点数如果不写精度和标度，则按照默认值`decimal(10,0)`来进行操作，并且如果数据超越了精度和标度值，系统则会报错。
## 日期和时间数据类型
| 数据类型 | 字节 | 最小值 | 最大值 |
| :--: | :--: | :--: | :--: |
| DATE | 4 | 1000-01-01 | 9999-12-31 |
| DATETIME | 8 | 1000-01-01 00:00:00 | 9999-12-31 23:59:59 |
| TIMESTAMP | 4 | 19700101080001 | 2038 年的某个时刻 |
| TIME | 3 | -838:59:59 | 838:59:59 |
| YEAR | 1 | 1901 | 2155 |

这些数据类型的主要区别如下： 
* 如果要用来表示年月日，通常用`DATE`来表示。
* 如果要用来表示年月日时分秒，通常用`DATETIME`表示。
* 如果只用来表示时分秒，通常用`TIME`来表示。
* 如果需要经常插入或者更新日期为当前系统时间，则通常使用`TIMESTAMP`来表示。`TIMESTAMP`值返回后显示为`YYYY-MM-DD HH:MM:SS`格式的字符串，显示宽度固定为 19 个字符。如果想要获得数字值，应在`TIMESTAMP`列添加`+0`。
* 如果只是表示年份，可以用`YEAR`来表示，它比`DATE`占用更少的空间。`YEAR`有 2 位或4 位格式的年。默认是 4 位格式。在 4 位格式中，允许的值是 1901~2155 和 0000。在 2 位格式中，允许的值是 70~69，表示从 1970～2069 年。MySQL 以`YYYY`格式显示`YEAR`值。

每种日期时间类型都有一个有效值范围，如果超出这个范围，在默认的 SQLMode 下，系统会进行错误提示，并将以零值来进行存储。

| 数据类型 | 零值表示 |
| :--: | :--: |
| DATETIME | 0000-00-00 00:00:00 |
| DATE | 0000-00-00 |
| TIMESTAMP | 00000000000000 |
| TIME | 00:00:00 |
| YEAR | 0000 |
