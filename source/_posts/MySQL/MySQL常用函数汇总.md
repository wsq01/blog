---
title: MySQL常用函数汇总
date: 2020-04-21 16:41:23
tags: [MySQL]
categories: [MySQL]
---

# 函数简介
MySQL 函数是 MySQL 数据库提供的内部函数，这些内部函数可以帮助用户更加方便地处理表中的数据。函数就像预定的公式一样存放在数据库里，每个用户都可以调用已经存在的函数来完成某些功能。

提示：函数就是输入值然后得到相应的输出结果，输入值称为参数（parameter），输出值称为返回值。

函数可以很方便的地实现业务逻辑的重用，并且 MySQL 数据库允许用户自己创建函数，以适应实际的业务操作。正确使用函数会让读者在编写 SQL 语句时起到事半功倍的效果。

MySQL 函数用来对数据表中的数据进行相应的处理，以便得到用户希望得到的数据，使 MySQL 数据库的功能更加强大。

下面将简单介绍 MySQL 中包含的几类函数，以及这几类函数的使用范围和作用。

MySQL 函数包括数学函数、字符串函数、日期和时间函数、条件判断函数、系统信息函数和加密函数等。这些函数不仅能帮助用户做很多事情，比如字符串的处理、数值的运算、日期的运算等，还可以帮助开发人员编写出简单快捷的 SQL 语句。

SELECT、INSERT、UPDATE 和 DELETE 语句及其子句（例如 WHERE、ORDER BY、HAVING 等）中都可以使用 MySQL 函数。例如，数据表中的某个数据是负数，现在需要将这个数据显示为整数，这时就可以在 SELECT 语句中使用绝对值函数。

下面介绍这几类函数的使用范围。
数学函数主要用于处理数字。这类函数包括绝对值函数、正弦函数、余弦函数和获得随机数的函数等。
字符串函数主要用于处理字符串。其中包括字符串连接函数、字符串比较函数、将字符串的字母都变成小写或大写字母的函数和获取子串的函数等。
日期和时间函数主要用于处理日期和时间。其中包括获取当前时间的函数、获取当前日期的函数、返回年份的函数和返回日期的函数等。
条件判断函数主要用于在 SQL 语句中控制条件选择。其中包括 IF 语句、CASE 语句和 WHERE 语句等。
系统信息函数主要用于获取 MySQL 数据库的系统信息。其中包括获取数据库名的函数、获取当前用户的函数和获取数据库版本的函数等。
加密函数主要用于对字符串进行加密解密。其中包括字符串加密函数和字符串解密函数等。
其他函数主要包括格式化函数和锁函数等。
# 数值型函数
## ABS函数：求绝对值
在 MySQL 中绝对值函数`ABS(x)`返回`x`的绝对值。正数的绝对值是其本身，负数的绝对值为其相反数，0 的绝对值是 0。

求 5、-2.4、-24 和 0 的绝对值。
```sql
mysql> SELECT ABS(5),ABS(-2.4),ABS(-24),ABS(0);
+--------+-----------+----------+--------+
| ABS(5) | ABS(-2.4) | ABS(-24) | ABS(0) |
+--------+-----------+----------+--------+
|      5 |       2.4 |       24 |      0 |
+--------+-----------+----------+--------+
1 row in set (0.10 sec)
```
## SQRT函数：求二次方根
在 MySQL 中平方根函数`SQRT(x)`返回非负数`x`的二次方根。负数没有平方根，返回结果为`NULL`。

求 25、120 和 -9 的二次平方根。
```sql
mysql> SELECT SQRT(25),SQRT(120),SQRT(-9);
+----------+--------------------+----------+
| SQRT(25) | SQRT(120)          | SQRT(-9) |
+----------+--------------------+----------+
|        5 | 10.954451150103322 |     NULL |
+----------+--------------------+----------+
1 row in set (0.06 sec)
```
也可以使用 SQRT 函数，计算出记录的平方根。

假设数据表`tb_people`有以下这些数据：
```sql
mysql> SELECT * FROM tb_people;
+------+------+------------+--------------------+
| id   | name | work_date  | daily_typing_pages |
+------+------+------------+--------------------+
|  1   | John | 2007-01-24 |        250         |
|  2   | Ram  | 2007-05-27 |        220         |
|  3   | Jack | 2007-05-06 |        170         |
|  3   | Jack | 2007-04-06 |        100         |
|  4   | Jill | 2007-04-06 |        220         |
|  5   | Zara | 2007-06-06 |        300         |
|  5   | Zara | 2007-02-06 |        350         |
+------+------+------------+--------------------+
7 rows in set (0.00 sec)
```
根据上面的表格，计算所有的`dialy_typing_pages`的平方根：
```sql
mysql> SELECT name, SQRT(daily_typing_pages)
  -> FROM tb_people;
+------+--------------------------+
| name | SQRT(daily_typing_pages) |
+------+--------------------------+
| John |        15.811388         |
| Ram  |        14.832397         |
| Jack |        13.038405         |
| Jack |        10.000000         |
| Jill |        14.832397         |
| Zara |        17.320508         |
| Zara |        18.708287         |
+------+--------------------------+
7 rows in set (0.00 sec)
```
## MOD函数：求余数
在 MySQL 中求余函数`MOD(x,y)`返回`x`被`y`除后的余数，`MOD()`对于带有小数部分的数值也起作用，它返回除法运算后的余数。

对 MOD(63,8)、MOD(120,10)、MOD(15.5,3) 进行求余运算。
```sql
mysql> SELECT MOD(63,8),MOD(120,10),MOD(15.5,3);
+-----------+-------------+-------------+
| MOD(63,8) | MOD(120,10) | MOD(15.5,3) |
+-----------+-------------+-------------+
|         7 |           0 |         0.5 |
+-----------+-------------+-------------+
1 row in set (0.03 sec)
```
## CEIL和CELING函数：向上取整
在 MySQL 中取整函数`CEIL(x)`和`CEILING(x)`的意义相同，返回不小于`x`的最小整数值，返回值转化为一个`BIGINT`。

使用`CEILING`函数返回最小整数。
```sql
mysql> SELECT CEIL(-2.5),CEILING(2.5);
+------------+--------------+
| CEIL(-2.5) | CEILING(2.5) |
+------------+--------------+
|         -2 |            3 |
+------------+--------------+
1 row in set (0.00 sec)
```
## FLOOR函数：向下取整
MySQL `FLOOR(x)`函数返回小于`x`的最大整数值。

求小于 5，5.66，-4，-4.66 的最大整数。
```sql
mysql> SELECT FLOOR(5),FLOOR(5.66),FLOOR(-4),FLOOR(-4.66);
+----------+-------------+-----------+--------------+
| FLOOR(5) | FLOOR(5.66) | FLOOR(-4) | FLOOR(-4.66) |
+----------+-------------+-----------+--------------+
|        5 |           5 |        -4 |           -5 |
+----------+-------------+-----------+--------------+
1 row in set (0.00 sec)
```
## RAND函数：生成随机数
MySQL `RAND()`函数被调用时，可以产生一个在 0 和 1 之间的随机数。
```sql
mysql>  SELECT RAND(), RAND(), RAND();
+------------------+-----------------+------------------+
| RAND()           | RAND()          | RAND()           |
+------------------+-----------------+------------------+
| 0.45464584925645 | 0.1824410643265 | 0.54826780459682 |
+------------------+-----------------+------------------+
1 row in set (0.00 sec) 
```
当使用整数作为参数调用时，`RAND()`使用该值作为随机数的种子发生器。每次种子使用给定值生成，`RAND()`将产生一个可重复的系列数字：
```sql
mysql> SELECT RAND(1),RAND(),RAND(1);
+---------------------+--------------------+---------------------+
| RAND(1)             | RAND()             | RAND(1)             |
+---------------------+--------------------+---------------------+
| 0.40540353712197724 | 0.7901452330780637 | 0.40540353712197724 |
+---------------------+--------------------+---------------------+
1 row in set (0.00 sec)
```
由运行结果可知，当向`RAND()`函数中传入一个整数作为参数是，`RAND()`函数产生的随机数可以重复。
## SIGN函数：返回参数的符号
在 MySQL 中符号函数`SIGN(x)`返回参数的符号，`x`的值为负、零和正时返回结果依次为 -1、0 和 1。

使用`SIGN`函数返回参数的符号。
```sql
mysql> SELECT SIGN(-6),SIGN(0),SIGN(34);
+----------+---------+----------+
| SIGN(-6) | SIGN(0) | SIGN(34) |
+----------+---------+----------+
|       -1 |       0 |        1 |
+----------+---------+----------+
1 row in set (0.00 sec)
```
## POW和POWER函数：求次方
MySQL `POW(x,y)`函数和`POWER(x,y)`函数用于计算`x`的`y`次方。

使用`POW(x,y)`和`POWER(x,y)`函数对参数`x`进行`y`次方的求值。
```sql
mysql> SELECT POW(5,-2),POW(10,3),POW(100,0),POWER(4,3),POWER(6,-3);
+-----------+-----------+------------+------------+----------------------+
| POW(5,-2) | POW(10,3) | POW(100,0) | POWER(4,3) | POWER(6,-3)          |
+-----------+-----------+------------+------------+----------------------+
|      0.04 |      1000 |          1 |         64 | 0.004629629629629629 |
+-----------+-----------+------------+------------+----------------------+
1 row in set (0.00 sec)
```
## SIN函数：求正弦值
MySQL 中正弦函数`SIN(x)`返回`x`的正弦值，其中`x`为弧度值。
```sql
mysql> SELECT SIN(1),SIN(0.5*PI());
+--------------------+---------------+
| SIN(1)             | SIN(0.5*PI()) |
+--------------------+---------------+
| 0.8414709848078965 |             1 |
+--------------------+---------------+
1 row in set (0.15 sec)
```
提示：`PI()`函数返回圆周率（3.141593）。
## ASIN函数：求反正弦值
MySQL 中反正弦函数`ASIN(x)`返回`x`的反正弦值，若`x`不在 -1 到 1 的范围之内，则返回`NULL`。
```sql
mysql> SELECT ASIN(0.8414709848078965),ASIN(2);
+--------------------------+---------+
| ASIN(0.8414709848078965) | ASIN(2) |
+--------------------------+---------+
|                        1 |    NULL |
+--------------------------+---------+
1 row in set (0.03 sec)
```
## COS函数：求余弦值
MySQL 中余弦函数`COS(x)`返回`x`的余弦值，`x`为弧度值。
```sql
mysql> SELECT COS(1),COS(0),COS(PI());
+--------------------+--------+-----------+
| COS(1)             | COS(0) | COS(PI()) |
+--------------------+--------+-----------+
| 0.5403023058681398 |      1 |        -1 |
+--------------------+--------+-----------+
1 row in set (0.03 sec)
```
## ACOS函数：求反余弦值
MySQL 中反余弦函数`ACOS(x)`。`x`值的范围必须在 -1 和 1 之间，否则返回`NULL`。
```sql
mysql> SELECT ACOS(2),ACOS(1),ACOS(-1);
+---------+---------+-------------------+
| ACOS(2) | ACOS(1) | ACOS(-1)          |
+---------+---------+-------------------+
|    NULL |       0 | 3.141592653589793 |
+---------+---------+-------------------+
1 row in set (0.01 sec)
```
## TAN函数：求正切值
MySQL 中正切函数`TAN(x)`返回`x`的正切值，`x`为给定的弧度值。
```sql
mysql> SELECT TAN(1),TAN(0);
+--------------------+--------+
| TAN(1)             | TAN(0) |
+--------------------+--------+
| 1.5574077246549023 |      0 |
+--------------------+--------+
1 row in set (0.03 sec)
```
## ATAN函数：求反正切值
MySQL 中反正切`ATAN(x)`返回`x`的反正切值，正切为`x`的值。
```sql
mysql> SELECT ATAN(1.5574077246549023),ATAN(0);
+--------------------------+---------+
| ATAN(1.5574077246549023) | ATAN(0) |
+--------------------------+---------+
|                        1 |       0 |
+--------------------------+---------+
1 row in set (0.05 sec)
```
## COT函数：求余切值
MySQL 余切函数`COT(x)`返回`x`的余切值，`x`是给定的弧度值。
```sql
mysql> SELECT COT(1);
+--------------------+
| COT(1)             |
+--------------------+
| 0.6420926159343306 |
+--------------------+
1 row in set (0.00 sec)
```
# 字符串函数
## LENGTH函数：获取字符串长度
MySQL `LENGTH(str)`函数的返回值为字符串的字节长度，使用`uft8`（`UNICODE`的一种变长字符编码，又称万国码）编码字符集时，一个汉字是 3 个字节，一个数字或字母是一个字节。

使用`LENGTH`函数计算字符串长度。
```sql
mysql> SELECT LENGTH('name'),LENGTH('数据库');
+----------------+---------------------+
|LENGTH('name')  | LENGTH('数据库')    |
+----------------+---------------------+
|              4 |                   9 |
+----------------+---------------------+
1 row in set (0.04 sec)
```
由运行结果可以看到，一个汉字是 3 个字节，“数据库”字符串占 9 个字节。英文字符的个数和所占的字节相同，一个字符占 1 个字节。
## CONCAT函数：字符串拼接
MySQL 中的`CONCAT(sl，s2，...)`函数返回结果为连接参数产生的字符串，或许有一个或多个参数。

若有任何一个参数为`NULL`，则返回值为`NULL`。若所有参数均为非二进制字符串，则结果为非二进制字符串。若自变量中含有任一二进制字符串，则结果为一个二进制字符串。
```sql
mysql> SELECT CONCAT('MySQL','5.7'),CONCAT('MySQL',NULL);
+-----------------------+----------------------+
| CONCAT('MySQL','5.7') | CONCAT('MySQL',NULL) |
+-----------------------+----------------------+
| MySQL5.7              | NULL                 |
+-----------------------+----------------------+
1 row in set (0.03 sec)
```
## INSERT函数：替换字符串
MySQL 中替换字符串函数`INSERT(s1，x，len，s2)`返回字符串`s1`，子字符串起始于`x`位置，并且用`len`个字符长的字符串代替`s2`。

若`x`超过字符串长度，则返回值为原始字符串。假如`len`的长度大于其他字符串的长度，则从位置`x`开始替换。若任何一个参数为`NULL`，则返回值为`NULL`。
```sql
mysql> SELECT INSERT('Football',2,4,'Play') AS col1,
    -> INSERT('Football',-1,4,'Play') AS col2,
    -> INSERT('Football',3,20,'Play') AS col3;
+----------+----------+--------+
| col1     | col2     | col3   |
+----------+----------+--------+
| FPlayall | Football | FoPlay |
+----------+----------+--------+
1 row in set (0.04 sec)
```
由执行结果可知：
* 第一个函数`INSERT('Football'，2，4，'Play')`将“Football”从第 2 个字符开始长度为 4 的字符串替换为`Play`，结果为`FPlayall`；
* 第二个函数`('Football'，-1，4，'Play')`中的起始位置 -1 超出了字符串长度，直接返回原字符串；
* 第三个函数`INSERT('Football'，3，20，'Play')`替换长度超出了原字符串长度，则从第 3 个字符开始，截取后面所有的字符，并替换为指定字符`Play`，结果为`FoPlay。
## LOWER函数：将字母转换成小写
MySQL 中字母小写转换函数`LOWER(str)`可以将字符串`str`中的字母字符全部转换成小写。
```sql
mysql> SELECT LOWER('BLUE'),LOWER('Blue');
+---------------+---------------+
| LOWER('BLUE') | LOWER('Blue') |
+---------------+---------------+
| blue          | blue          |
+---------------+---------------+
1 row in set (0.03 sec)
```
## UPPER函数：将字母转换成大写
MySQL 中字母大写转换函数`UPPER(str)`可以将字符串`str`中的字母字符全部转换成大写。
```sql
mysql> SELECT UPPER('green'),UPPER('Green');
+----------------+----------------+
| UPPER('green') | UPPER('Green') |
+----------------+----------------+
| GREEN          | GREEN          |
+----------------+----------------+
1 row in set (0.03 sec)
```
## LEFT函数：从左侧截取字符串
MySQL 中的`LEFT(s，n)`函数返回字符串`s`最左边的`n`个字符。
```sql
mysql> SELECT LEFT('MySQL',2);
+-----------------+
| LEFT('MySQL',2) |
+-----------------+
| My              |
+-----------------+
1 row in set (0.04 sec)
```
由运行结果可知，返回字符串“MySQL”左边开始的长度为 2 的子字符串，结果为“My”。
## RIGHT函数：从右侧截取字符串
MySQL 中的`RIGHT(s，n)`函数返回字符串`s`最右边的`n`个字符。
```sql
mysql> SELECT RIGHT('MySQL',3);
+------------------+
| RIGHT('MySQL',3) |
+------------------+
| SQL              |
+------------------+
1 row in set (0.00 sec)
```
## TRIM函数：删除空格
MySQL 中删除空格函数`TRIM(s)`删除字符串`s`两侧的空格。
```sql
mysql> SELECT '[   mobile   ]',CONCAT('[',TRIM('   mobile   '),']');
+----------------+--------------------------------------+
| [   mobile   ] | CONCAT('[',TRIM('   mobile   '),']') |
+----------------+--------------------------------------+
| [   mobile   ] | [mobile]                             |
+----------------+--------------------------------------+
1 row in set (0.07 sec)
```
## REPLACE函数：字符串替换
MySQL 中替换函数`REPLACE(s，s1，s2)`使用字符串`s2`替换字符串`s`中所有的字符串`s1`。
```sql
mysql> SELECT REPLACE('aaa.mysql.com','a','w');
+----------------------------------+
| REPLACE('aaa.mysql.com','a','w') |
+----------------------------------+
| www.mysql.com                    |
+----------------------------------+
1 row in set (0.00 sec)
```
## SUBSTRING函数：截取字符串
MySQL 中获取子串函数`SUBSTRING(s，n，len)`带有`len`参数的格式，从字符串`s`返回一个长度同`len`字符相同的子字符串，起始于位置`n`。

也可能对`n`使用一个负值。假若这样，则子字符串的位置起始于字符串结尾的第`n`个字符，即倒数第`n`个字符，而不是字符串的开头位置。
```sql
mysql> SELECT SUBSTRING('computer',3) AS col1,
    -> SUBSTRING('computer',3,4) AS col2,
    -> SUBSTRING('computer',-3) AS col3,
    -> SUBSTRING('computer',-5,3) AS col4;
+--------+------+------+------+
| col1   | col2 | col3 | col4 |
+--------+------+------+------+
| mputer | mput | ter  | put  |
+--------+------+------+------+
1 row in set (0.00 sec)
```
## REVERSE函数：反转字符串
MySQL 中字符串逆序函数`REVERSE(s)`可以将字符串`s`反转，返回的字符串的顺序和`s`字符串的顺序相反。
```sql
mysql> SELECT REVERSE('hello');
+------------------+
| REVERSE('hello') |
+------------------+
| olleh            |
+------------------+
1 row in set (0.00 sec)
```
# 聚合函数
## MAX函数：查询指定列的最大值
MySQL `MAX()`函数是用来返回指定列中的最大值。

为了方便理解，首先创建一个学生成绩表`tb_students_score`，学生成绩表的数据内容如下所示。
```sql
mysql> use test_db;
Database changed
mysql> SELECT * FROM tb_students_score;
+--------------+---------------+
| student_name | student_score |
+--------------+---------------+
| Dany         |            90 |
| Green        |            99 |
| Henry        |            95 |
| Jane         |            98 |
| Jim          |            88 |
| John         |            94 |
| Lily         |           100 |
| Susan        |            96 |
| Thomas       |            93 |
| Tom          |            89 |
+--------------+---------------+
10 rows in set (0.13 sec)
```
在`tb_students_score`表中查找最高的成绩=。
```sql
mysql> SELECT MAX(student_score)
    -> AS max_score
    -> FROM tb_students_score;
+-----------+
| max_score |
+-----------+
|       100 |
+-----------+
1 row in set (0.06 sec)
```
`MAX()`函数不仅适用于查找数值类型，也可应用于字符类型。

在`tb_students_score`表中查找`student_name`的最大值。
```sql
mysql> SELECT MAX(student_name)
    -> AS max_name
    -> FROM tb_students_score;
+----------+
| max_name |
+----------+
| Tom      |
+----------+
1 row in set (0.03 sec)
```
由运行结果可以看到，MAX() 函数可以对字母进行大小判断，并返回最大的字符或者字符串值。

> 注意：MAX() 函数还可以返回任意列中的最大值，包括返回字符类型的最大值。在对字符类型的数据进行比较时，按照字符的 ASCII 码值大小进行比较，从 a～z，a 的 ASCII 码最小，z 的最大。在比较时，先比较第一个字符，如果相等，继续比较下一个字符，一直到两个字符不相等或者字符结束为止。例如，b 与 t 比较时，t 为最大值；bcd 与 bca 比较时，bcd 为最大值。

## MIN函数：查询指定列的最小值
MySQL `MIN()`函数是用来返回查询列中的最小值。

在`tb_students_score`表中查找最低的成绩。
```sql
mysql> SELECT MIN(student_score)
    -> AS min_score
    -> FROM tb_students_score;
+-----------+
| min_score |
+-----------+
|        88 |
+-----------+
1 row in set (0.00 sec)
```
> 提示：`MIN()`函数与`MAX()`函数类似，不仅适用于查找数值类型，也可应用于字符类型。

## COUNT函数：统计查询结果的行数
MySQL `COUNT()`函数统计数据表中包含的记录行的总数，或者根据查询结果返回列中包含的数据行数，使用方法有以下两种：
* `COUNT(*)`计算表中总的行数，无论某列有数值或者为空值。
* `COUNT（字段名）`计算指定列下总的行数，计算时将忽略空值的行。

查询`tb_students_score`表中总的行数。
```sql
mysql> SELECT COUNT(student_name)
    -> AS students_number
    -> FROM tb_students_score;
+-----------------+
| students_number |
+-----------------+
|              10 |
+-----------------+
1 row in set (0.03 sec)
```
提示：在计算总数的时候对待`NULL`值的方式是，指定列的值为空的行被`COUNT()`函数忽略，但若不指定列，而在`COUNT()`函数中使用星号`*`，则所有记录都不忽略。
## SUM函数：求和
MySQL `SUM()`是一个求总和的函数，返回指定列值的总和。

`SUM()`函数是如何工作的？

如果在没有返回匹配行`SELECT`语句中使用`SUM`函数，则`SUM`函数返回`NULL`，而不是 0。

`DISTINCT`运算符允许计算集合中的不同值。

`SUM`函数忽略计算中的`NULL`值。

在`tb_students_score`表中计算学生成绩的总分。
```sql
mysql> SELECT SUM(student_score)
    -> AS score_sum
    -> FROM tb_students_score;
+-----------+
| score_sum |
+-----------+
|       942 |
+-----------+
1 row in set (0.00 sec)
```
> 提示：`SUM()`函数在计算时，忽略列值为`NULL`的行。

## AVG函数：求平均值
MySQL `AVG()`函数通过计算返回的行数和每一行数据的和，求得指定列数据的平均值。

在`tb_students_score`表中，查询所有学生成绩的平均值。
```sql
mysql> SELECT AVG(student_score)
    -> AS score_avg
    -> FROM tb_students_score;
+-----------+
| score_avg |
+-----------+
|   94.2000 |
+-----------+
1 row in set (0.03 sec)
```
> 提示：使用`AVG()`函数时，参数为要计算的列名称，若要得到多个列的平均值，则需要在每一列都使用`AVG()`函数。

# 流程控制函数
## IF函数：判断
MySQL `IF`语句允许您根据表达式的某个条件或值结果来执行一组 SQL 语句。

要在 MySQL 中形成一个表达式，可以结合文字，变量，运算符，甚至函数来组合。表达式可以返回`TRUE,FALSE`或`NULL`，这三个值之一。
```sql
IF(expr,v1,v2)
```
其中：表达式`expr`得到不同的结果，当`expr`为真是返回`v1`的值，否则返回`v2`。

使用`IF(expr,v1,v2)`函数根据`expr`表达式结果返回相应值。
```sql
mysql> SELECT IF(1<2,1,0) c1,IF(1>5,'√','×') c2,IF(STRCMP('abc','ab'),'yes','no') c3;
+----+----+-----+
| c1 | c2 | c3  |
+----+----+-----+
|  1 | × | yes |
+----+----+-----+
1 row in set, 2 warnings (0.00 sec)
```
由执行结果可以看出，在`c1`中，表达式 1<2 所得的结果是`TRUE`，则返回结果为`v1`，即数值 1；在`c2`中，表达式 1>5 所得的结果是`FALSE`，则返回结果为`v2`，即字符串`'×'`；在`c3`中，先用`STRCMP(s1,s2)`函数比较两个字符串的大小，字符串`'abc'`和`'ab'`比较结果的返回值为 1，也就是表达式`expr`的返回结果不等于 0 且不等于`NULL`，则返回值为`v1`，即字符串`'yes'`。
## IFNULL函数：判断是否为空
MySQL `IFNULL`函数是 MySQL 控制流函数之一，它接受两个参数，如果不是`NULL`，则返回第一个参数。 否则，`IFNULL`函数返回第二个参数。两个参数可以是文字值或表达式。
```sql
IFNULL(v1,v2);
```
其中：如果`v1`不为`NULL`，则`IFNULL`函数返回`v1`; 否则返回`v2`的结果。

使用`IFNULL(v1,v2)`函数根据`v1`的取值返回相应值。
```sql
mysql> SELECT IFNULL(5,8),IFNULL(NULL,'OK'),IFNULL(SQRT(-8),'FALSE'),SQRT(-8);
+-------------+-------------------+--------------------------+----------+
| IFNULL(5,8) | IFNULL(NULL,'OK') | IFNULL(SQRT(-8),'FALSE') | SQRT(-8) |
+-------------+-------------------+--------------------------+----------+
|           5 | OK                | FALSE                    |     NULL |
+-------------+-------------------+--------------------------+----------+
1 row in set (0.00 sec)
```
由执行结果可以看出，`IFNULL(v1,v2)`函数中的参数`v1=5、v2=8`，都不为空，即`v1=5`不为空，返回`v1`的值为 5；当`v1=NULL`时，返回`v2`的值，即字符串`'OK'`；当`v1=SQRT(-8)`时，`SQRT(-8)`函数的返回值为`NULL`，即`v1=NULL`，所以返回 v2 为字符串`'false'`。
## CASE函数：搜索语句
除了`IF`函数，MySQL 还提供了一个替代的条件语句`CASE`。 MySQL `CASE`语句使代码更加可读和高效。

`CASE`语句有两种形式：简单的和可搜索`CASE`语句。
## 简单的 CASE 语句
简单的`CASE`语句就是指使用简单`CASE`语句来检查表达式的值与一组唯一值的匹配。
```sql
CASE  <表达式>
   WHEN <值1> THEN <操作>
   WHEN <值2> THEN <操作>
   ...
   ELSE <操作>
END CASE;
```
其中：<表达式> 可以是任何有效的表达式。我们将 <表达式> 的值与每个 WHEN 子句中的值进行比较，例如 <值1>，<值2> 等。如果 <表达式> 和 <值n> 的值相等，则执行相应的`WHEN`分支中的命令 <操作>。如果`WHEN`子句中的 <值n> 没有与 <表达式> 的值匹配，则`ELSE`子句中的命令将被执行。`ELSE`子句是可选的。 如果省略`ELSE`子句，并且找不到匹配项，MySQL 将引发错误。

使用`CASE`函数根据表达式的取值返回相应值。
```sql
mysql> SELECT CASE WEEKDAY(NOW()) WHEN 0 THEN '星期一' WHEN 1 THEN '星期二' WHEN
2 THEN '星期三' WHEN 3 THEN '星期四' WHEN 4 THEN '星期五' WHEN 5 THEN '星期六'
ELSE '星期天' END AS COLUMN1,NOW(),WEEKDAY(NOW()),DAYNAME(NOW());
+---------+---------------------+----------------+----------------+
| COLUMN1 | NOW()               | WEEKDAY(NOW()) | DAYNAME(NOW()) |
+---------+---------------------+----------------+----------------+
| 星期四  | 2019-02-28 13:45:43 |              3 | Thursday       |
+---------+---------------------+----------------+----------------+
1 row in set, 7 warnings (0.00 sec)
```
由执行结果可以看出，`NOW()`函数得到当前系统时间是 2019 年 2 月 28 日，`DAYNAME(NOW())`得到当天是`'Thursday'`，`WEEKDAY(NOW())`函数返回当前时间的工作日索引是 3，即对应的是星期四。
## 可搜索的 CASE 语句
简单`CASE`语句仅允许将表达式的值与一组不同的值进行匹配。 为了执行更复杂的匹配，如范围，则可以使用可搜索`CASE`语句。 可搜索`CASE`语句等同于`IF`语句，但是它的构造更加可读。
```sql
CASE
    WHEN <条件1> THEN <命令>
    WHEN <条件2> THEN <命令>
    ...
    ELSE commands
END CASE;
```
MySQL 分别计算`WHEN`子句中的每个条件，直到找到一个值为`TRUE`的条件，然后执行`THEN`子句中的相应 <命令>。如果没有一个条件为`TRUE`，则执行`ELSE`子句中的 <命令>。如果不指定`ELSE`子句，并且没有一个条件为`TRUE`，MySQL 将发出错误消息。MySQL 不允许在`THEN`或`ELSE`子句中使用空的命令。 如果您不想处理`ELSE`子句中的逻辑，同时又要防止 MySQL 引发错误，则可以在`ELSE`子句中放置一个空的`BEGIN END`块。

使用`CASE`函数根据表达式的取值返回相应值。
```sql
mysql> SELECT CASE WHEN WEEKDAY(NOW())=0 THEN '星期一' WHEN WEEKDAY(NOW())=1 THE
N '星期二'  WHEN WEEKDAY(NOW())=2 THEN '星期三' WHEN WEEKDAY(NOW())=3 THEN '星期
四' WHEN WEEKDAY(NOW())=4 THEN '星期五' WHEN WEEKDAY(NOW())=5 THEN '星期六' WHEN
WEEKDAY(NOW())=6 THEN '星期天' END AS COLUMN1,NOW(),WEEKDAY(NOW()),DAYNAME(NOW(
));
+---------+---------------------+----------------+----------------+
| COLUMN1 | NOW()               | WEEKDAY(NOW()) | DAYNAME(NOW()) |
+---------+---------------------+----------------+----------------+
| 星期四  | 2019-02-28 14:08:00 |              3 | Thursday       |
+---------+---------------------+----------------+----------------+
1 row in set, 7 warnings (0.00 sec)
```
此例跟上例的返回结果一样，只是使用了`CASE`函数的不同写法，`WHEN`后面为表达式，当表达式的返回结果为`TRUE`时取`THEN`后面的值，如果都不是，则返回`ELSE`后面的值。