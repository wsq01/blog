


# TCP/IP网络访问层的构成
网络访问层是TCP/IP协议栈的最底层，它提供物理网络的接口，实现对复杂数据的发送和接收。网络访问层协议为网络接口、数据传输提供了对应的技术规范。

在 TCP/IP 协议中，网络访问层对应 OSI 七层网络模型的物理层和数据链路层。
## 物理层
物理层是 OSI 七层网络模型中的第 1 层，是整个开放系统的基础。在进行数据传输时，物理层的作用是提供传送数据的通路和可靠的环境。

对于计算机来说，物理层对应的就是网络适配器（通常意义上的“网卡”）。

根据网络适配器的存在方式，可以分为两类。
* 第一类是物理网络适配器，如有线网卡、无线网卡。
* 第二类是虚拟网络适配器，如宽带拨号连接、VPN 连接等。

显示计算机上的网络适配器信息，执行命令如下：
```
root@daxueba:~# netwox 169
```
输出信息如下：
```
Lo0 127.0.0.1 notether
Lo0 ::1 notether
Eth0 192.168.59.131 00:0C:29:CA:E4:66
Eth0 fd15:4ba5:5a2b:1008:20c:29ff:feca:e466 00:0C:29:CA:E4:66
Eth0 fd15:4ba5:5a2b:1008:61f8:89cd:3207:9d0 00:0C:29:CA:E4:66
Eth0 fe80::20c:29ff:feca:e466 00:0C:29:CA:E4:66
```
从输出信息可以看到，该计算机中存在两类网络适配器，分别为`Lo`和`Eth`。其中，`Lo`表示回环接口，它是虚拟网络适配器；`Eth`为以太网网络适配器。

如果同类型设备有多个，会在后面添加数字编号。编号从 0 开始，表示该类型的网络接口的第一个设备。
## 数据链路层
数据链路层是 OSI 七层网络模型中的第 2 层，介于物理层与网络层之间，用来为网络层提供数据传送服务。它定义了数据传输的起始位置，并且通过一些规则来控制这些数据的传输，以保证数据传输的正确性。

由于数据链路层完成以上两个独立的任务，所以相应地划分为两个子层，其含义如下：
* 介质访问控制（`Media Access Control，MAC`）：提供与网络适配器连接的接口。实际上，网络适配器驱动程序通常被称为 MAC 驱动，而网卡在工厂固化的硬件地址通常被称为 MAC 地址。
* 逻辑链路控制（`Logical Link Control，LLC`）：这个子层对经过子网传递的帧进行错误检查，并且管理子网上通信设备之间的链路。

# 网络体系的构成和类型
网络体系定义了物理网络的构成，以及对应的通信协议。例如，有线网络和无线网络是两种不同的网络体系。
## 网络体系的构成
由于网络体系不仅定义了网络构成，还规定了通信方式，所以它包括以下 4 个方面。
* 访问方法：定义了计算机使用传输介质的规则。通过这些规则，可以避免数据传输的各种冲突。
* 数据帧格式：定义了数据传输的格式。所有要传输的数据必须按照该格式进行传输。
* 布线类型：定义了网络适配器和其他网络设备的连接方式。例如，每台计算机都通过电缆连接到网络设备，从而形成星型网络。
* 布线规则：定义网络适配器和网络设备连接规范，如网络适配器接口类型和连线长度等。

## 网络体系的类型
由于网络使用的场景和数据传输所使用的终端设备不同，在物理层中识别的网络接口设备也会不同。

网络体系主要分为 4 大类型，每种类型及使用范围如下：
* IEEE 802.3（以太网）：在大多数办公室和家庭中使用的基于线缆的网络，就是常见的有线局域网。
* IEEE 802.11（无线网络）：在办公室、家庭和咖啡厅使用的无线网络技术，如 Wi-Fi 网络。
* IEEE 802.16（WiMAX）：用于移动通信长距离无线连接的技术。
* 点到点协议（PPP）：使用 Modem 通过电话线进行连接的技术，如通过拨号方式建立的网络连接。

# 物理地址（MAC地址）
物理地址是一种标识符，用来标记网络中的每个设备。同现实生活中收发快递一样，网络内传输的所有数据包都会包含发送方和接收方的物理地址。

由于网络设备对物理地址的处理能力有限，物理地址只在当前局域网内有效。所以，接收方的物理地址都必须存在于当前局域网内，否则会导致发送失败。

MAC 地址的英语是`Media Access Control Address`，直译为媒体存取控制位址，也称为局域网地址（`LAN Address`）、以太网地址（`Ethernet Address`）或物理地址（`Physical Address`），它是一个用来确认网络设备位置的位址。
## MAC 地址是预留的
由于数据包中都会包含发送方和接收方的物理地址，数据包从起始地发送到目的地，为了能够正确地将数据包发送出去，就必须要求 MAC 地址具有唯一性。因此 MAC 地址都是由生产厂家在生产时固化在网络硬件中，是硬件预留的地址。
## MAC 地址格式
硬件的 MAC 地址是厂家按照一定的规则，进行设置所产生的，因此，MAC 地址拥有自己的格式。

MAC 地址采用十六进制数表示，共 6 个字节（48 位），长度为 48bit（字节）。整个地址可以分为前 24 位和后 24 位，代表不同的含义。
* 前 24 位称为组织唯一标识符（`Organizationally Unique Identifier，OUI`），是由 IEEE 的注册管理机构给不同厂家分配的代码，区分了不同的厂家。
* 后 24 位是由厂家自己分配的，称为扩展标识符。同一个厂家生产的网卡中 MAC 地址后 24 位是不同的。

## 查看网络主机 MAC 地址信息
一个局域网或公司中往往存在多台计算机，这些计算机都有自己的 MAC 地址和 IP 地址。其中，IP 地址是可变的，而 MAC 地址一般是不可变的。为了准确地识别主机，用户可以获取计算机对应的 MAC 地址。
### 示例
显示网络主机 MAC 地址信息。
1. 显示局域网中指定主机的 MAC 地址信息。例如，显示主机`192.168.59.133`的 MAC 地址。执行命令如下：
```
root@daxueba:~# netwox 5 -i 192.168.59.133
```
输出信息如下：
```
192.168.59.133       00:0C:29:D0:21:23
```
输出信息表示主机`192.168.59.133`的 MAC 地址为`00:0C:29:D0:21:23`。
2. 显示局域网中所有主机的 MAC 地址，执行命令如下：
```
root@daxueba:~# netwox 5 -i 192.168.59.0/24
```
输出所有主机的 MAC 地址如下：
```
192.168.59.1            00:50:56:C0:00:08
192.168.59.2            00:50:56:EA:F3:A1
192.168.59.131          00:0C:29:CA:E4:66
192.168.59.132          00:0C:29:C4:8A:DE
192.168.59.133          00:0C:29:D0:21:23
192.168.59.254          00:50:56:F0:69:32
```
3. 在显示局域网中所有主机的 MAC 地址信息时，有时由于暂时没有发现主机，等待较长的时间，也不会有任何输出信息。

为了能够更好地了解当前的进度，可以使用`-u`选项，显示未发现主机的 MAC 地址的信息，进而可以查看扫描进度。
```
root@daxueba:~# netwox 5 -i 192.168.59.0/24 -u
```
输出信息如下：
```
192.168.59.0            unresolved
192.168.59.1            00:50:56:C0:00:08
192.168.59.2            00:50:56:EA:F3:A1
192.168.59.3            unresolved
…  #省略其他信息
192.168.59.131         00:0C:29:CA:E4:66
192.168.59.132         00:0C:29:C4:8A:DE
192.168.59.133         00:0C:29:D0:21:23
192.168.59.134         unresolved
192.168.59.135         unresolved
…  #省略其他信息
192.168.59.254         00:50:56:F0:69:32
192.168.59.255         unresolved
```
从输出信息可以看到，程序对局域网中的所有主机进行了扫描，主机 IP 地址为`192.168.59.0`到`192.168.59.255`。

如果扫描的主机存在，则给出对应的 MAC 地址；如果主机不存在，则显示为`unresolved`。
## 根据 MAC 地址获取主机其他信息
进行数据传输的主机不仅拥有 MAC 地址，还拥有路由器分配的 IP 地址，有的还会有自己的主机名、标题等信息。如果知道了主机的 MAC 地址信息，那么就可以使用`netwox`工具获取该主机的这些信息。
### 示例
已知一主机的 MAC 地址为`00:0C:29:CA:E4:66`，显示该主机的其他信息。

1. 显示该主机相关信息，执行命令如下：
```
root@daxueba:~# netwox 4 -e 00:0C:29:CA:E4:66
```
输出信息如下：
```
IP address:   192.168.59.131
Hostname:    localhost
Hostnames:   localhost
```
从输出信息可以看到，该主机的 IP 地址为`192.168.59.131`，主机名为`localhost`。
2. 如果在显示信息时只想显示 IP 地址信息，可以使用`--ip`选项：
```
root@daxueba:~# netwox 4 -e 00:0C:29:CA:E4:66 --ip
```
输出信息只有IP地址信息，如下：
```
192.168.59.131
```
3. 如果在显示信息时只想显示主机名信息，可以使用`--host`选项：
```
root@daxueba:~# netwox 4 -e 00:0C:29:CA:E4:66 --host
```
输出信息只有主机名信息，如下：
```
localhost
```
4. 如果在显示信息时只想显示标题信息，可以使用`--title`选项：
```
root@daxueba:~# netwox 4 -e 00:0C:29:CA:E4:66 --title
```
执行命令后，如果没有输出信息，表示该主机没有标题信息。









